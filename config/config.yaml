experiment:
  name: "imputacao_estadiamento_inca_2026"
  random_seed: 42
  n_sample: 100000

data:
  filepath: "data/raw/df_raw.parquet"
  target_col: "ESTADIAM"
  valid_classes: [0, 1, 2, 3, 4, 88]
  exclude_classes: [99]
  missing_threshold: 0.60
  date_filter_col: "DATAPRICON"
  year_min: 2013
  year_max: 2023
  high_cardinality_min_freq: 100

  features_safe:
    - SEXO
    - IDADE
    - LOCALNAS
    - RACACOR
    - INSTRUC
    - CLIATEN
    - HISTFAMC
    - ALCOOLIS
    - TABAGISM
    - ESTADRES
    - PROCEDEN
    - ANOPRIDI
    - ORIENC
    - ESTCONJ
    - ANTRI
    - DTPRICON
    - DIAGANT
    - LOCTUDET
    - LOCTUPRI
    - LATERALI
    - LOCTUPRO
    - MAISUMTU
    - CNES
    - UFUH
    - MUUH
    - OCUPACAO

  features_high_cardinality:
    - PROCEDEN
    - LOCTUPRI
    - LOCTUPRO
    - OCUPACAO
    - CNES
    - MUUH
    - ANTRI
    - ANOPRIDI

  num_cols:
    - IDADE

  features_exclude:
    - CLITRAT
    - DATAINITRT
    - DATAOBITO
    - DATAPRICON
    - DTDIAGNO
    - DTINITRT
    - DTTRIAGE
    - ESTADIAG
    - ESTDFIMT
    - OUTROESTA
    - TNM
    - TPCASO
    - VALOR_TOT

cv:
  n_outer_folds: 5
  n_inner_folds: 5

temporal_validation:
  train_end_year: 2020
  test_start_year: 2021
  test_end_year: 2023

imputation:
  imputers: [Media, Mediana, kNN, MICE, MICE_XGBoost, MissForest, NoImpute]
  params:
    knn_neighbors: 5
    knn_max_fit_samples: 30000
    mice_max_iter: 10
    missforest_max_iter: 5
    missforest_n_estimators: 100
    missforest_max_depth: 12
    xgb_max_iter: 5
    xgb_n_estimators: 100
    xgb_max_depth: 6
    xgb_learning_rate: 0.1

classification:
  classifiers: [XGBoost, cuML_RF, cuML_SVM]
  baselines:
    xgboost_native_missing: true
    catboost_raw_no_encoding: true
  svm_max_train_samples: null
  tuning:
    n_iter: 20
    n_iter_svm: 10
    scoring: "f1_weighted"
  params:
    XGBoost:
      n_estimators: [100, 200, 300, 500]
      max_depth: [3, 5, 7, 10]
      learning_rate: [0.01, 0.05, 0.1, 0.2]
      subsample: [0.6, 0.8, 1.0]
      colsample_bytree: [0.6, 0.8, 1.0]
      min_child_weight: [1, 3, 5, 7]
      gamma: [0, 0.1, 0.3]
      reg_alpha: [0, 0.01, 0.1]
      reg_lambda: [1, 1.5, 2]
    cuML_RF:
      n_estimators: [200, 400, 600]
      max_depth: [8, 12, 16, 20]
      max_features: ["sqrt", "log2", 1.0]
      n_bins: [64, 128]
    cuML_SVM:
      C: [0.01, 0.1, 1, 10, 100]
      kernel: ["rbf"]
      gamma: ["scale", "auto"]
    CatBoost:
      iterations: [300, 500, 800]
      depth: [4, 6, 8, 10]
      learning_rate: [0.03, 0.05, 0.1]
      l2_leaf_reg: [1, 3, 5, 7]

metrics:
  average: "weighted"
  auc_multi_class: "ovr"

paths:
  raw_data: "data/raw"
  processed_data: "data/processed"
  imputed_data: "data/imputed"
  results_raw: "results/raw"
  results_tables: "results/tables"
  results_figures: "results/figures"

hardware:
  use_gpu: true
  gpu_device: "cuda"
  gpu_id: 0
  svm_cache_mb: 2000

protocol:
  primary_metric: f1_weighted
  secondary_metrics: [f1_macro, qwk_0_4]
  alpha: 0.05
  equivalence_margin: 0.01
  sensitivity_margin: 0.005
  outer_folds: 5
  inner_folds: 5
  repeats: 5
  seed_schedule: [42, 123, 456, 789, 1024]
  tuning_budget: 30
  permutation_n_perms: 10000
  bootstrap_iters: 5000
  # --- correctness & reproducibility ---
  inner_refit_imputer: true # re-fit full pipeline (encode→impute→scale→clf) on each inner fold
  stats_seed: 42 # base seed for per-comparison RNG derivation
  checkpoint_strict: true # invalidate checkpoint when signature diverges
  global_agg: mean # aggregation fn for classifiers in global pivot (mean | median)
  class88_margin: 0.01 # degradation threshold for class-88 guardrails
